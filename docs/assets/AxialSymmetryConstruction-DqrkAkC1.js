import{r as m,j as z,A as Je}from"./index-Dmlh2Fx8.js";import{u as Qe,F as Me}from"./slider-CvW1X_8i.js";import{C as xe,a as et}from"./ConstructionStepLog-Dz6wyEkV.js";function it({onBack:ue,darkMode:d,onDarkModeChange:Te}){const pe=Qe(),E=m.useRef(null),k=m.useRef(null),J=m.useRef(null),ne=m.useRef(),[R,je]=m.useState(0),[j,oe]=m.useState(pe?.2:.4),[A,$]=m.useState({x:0,y:0}),[se,Q]=m.useState(!1),[M,ce]=m.useState({x:0,y:0}),[p,Ae]=m.useState({width:1920,height:1080}),[U,fe]=m.useState(0),[de,ie]=m.useState(!0),[G,Ye]=m.useState(!0),[O,re]=m.useState(!1),[D,ye]=m.useState({x:600,y:700}),[N,he]=m.useState({x:1100,y:900}),[W,ge]=m.useState({x:800,y:400}),[K,Z]=m.useState(null),[me,x]=m.useState(null),[be,ze]=m.useState(!1),r=1400,[Ie,ve]=m.useState(!1),[Xe,ke]=m.useState(0),[De,Ne]=m.useState(1),[ee,We]=m.useState({x:0,y:0});m.useEffect(()=>{k.current||(k.current=document.createElement("canvas"))},[]);const te=m.useRef(null),[tt,Be]=m.useState(!1);m.useEffect(()=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{te.current=e,Be(!0)},e.onerror=()=>{console.error("Failed to load ruler image")},e.src="https://jjpiguuubvmiobmixwgh.supabase.co/storage/v1/object/public/Admin%20math/pravitko4.svg"},[]);const ae=m.useRef(null),[Ee,Le]=m.useState(!1);m.useEffect(()=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{ae.current=e,Le(!0)},e.onerror=()=>{console.error("Failed to load compass image")},e.src="https://jjpiguuubvmiobmixwgh.supabase.co/storage/v1/object/public/Admin%20math/kruzitko.svg"},[]);const H=(e,i)=>({x:(e-A.x)/j,y:(i-A.y)/j}),L=(e,i,l=15)=>{const t=e.x-i.x,n=e.y-i.y;return Math.sqrt(t*t+n*n)<l},F=(e,i,l)=>{const t=e.x*j+A.x,n=e.y*j+A.y,o=t+l.x,f=n+l.y,v=20,w=i.x-o,a=i.y-(f-8);return Math.sqrt(w*w+a*a)<v},we=()=>{if(!p.width||!p.height)return;const e=p.width/2,i=p.height/2,l=(D.y+N.y+W.y)/3;$({x:e-r*j,y:i-l*j})};m.useEffect(()=>{const e=()=>{J.current&&Ae({width:J.current.clientWidth,height:J.current.clientHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),m.useEffect(()=>{p.width>0&&p.height>0&&(we(),be||ze(!0))},[p.width,p.height,be]),m.useEffect(()=>{const e=E.current,i=k.current;if(!e||!i)return;const l=window.devicePixelRatio||1;e.width=p.width*l,e.height=p.height*l,i.width=p.width*l,i.height=p.height*l},[p]),m.useEffect(()=>{if(!de)return;const e=()=>{fe(i=>i>=1?(ie(!1),1):Math.min(i+.008,1))};return U<1?ne.current=requestAnimationFrame(e):U>=1&&ie(!1),()=>{ne.current&&cancelAnimationFrame(ne.current)}},[de,U,R]);const Fe=e=>{const i=50*j;e.strokeStyle=d?"rgba(125, 107, 194, 0.15)":"rgba(229, 231, 235, 0.8)",e.lineWidth=1;const l=A.x%i,t=A.y%i;for(let n=l;n<=p.width;n+=i)e.beginPath(),e.moveTo(n,0),e.lineTo(n,p.height),e.stroke();for(let n=t;n<=p.height;n+=i)e.beginPath(),e.moveTo(0,n),e.lineTo(p.width,n),e.stroke()},c=(e,i,l,t="#000",n=12,o=-12,f=1)=>{e.save(),e.setTransform(f,0,0,f,0,0);const v=i.x*j+A.x,w=i.y*j+A.y;e.font="bold 16px Inter, system-ui, sans-serif";const s=e.measureText(l).width,b=8,y=v+n+s/2,g=w+o-8,S=Math.max(s,16)/2+b;e.fillStyle="#3b82f6",e.beginPath(),e.arc(y,g,S,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.textAlign="center",e.textBaseline="middle",e.fillText(l,y,g),e.restore()},h=(e,i,l,t="#000")=>{e.fillStyle=d?"rgba(75, 85, 99, 0.4)":"rgba(200, 200, 200, 0.3)",e.beginPath(),e.arc(i.x,i.y,10,0,Math.PI*2),e.fill(),e.fillStyle=t,e.beginPath(),e.arc(i.x,i.y,7,0,Math.PI*2),e.fill(),e.strokeStyle=d?"#111827":"#ffffff",e.lineWidth=2,e.beginPath(),e.arc(i.x,i.y,7,0,Math.PI*2),e.stroke()},u=(e,i,l,t="#000",n=2,o=1,f=!1)=>{let v=0;o<=.15?v=0:o>=.85?v=1:v=(o-.15)/.7;const w={x:i.x+(l.x-i.x)*v,y:i.y+(l.y-i.y)*v},a=v<1;f&&a&&v>0&&(e.strokeStyle="rgba(251, 191, 36, 0.5)",e.lineWidth=n*10,e.lineCap="round",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(w.x,w.y),e.stroke()),e.strokeStyle=t,e.lineWidth=a&&f?n*1.5:n,e.lineCap="round",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(w.x,w.y),e.stroke()},le=(e,i,l,t,n)=>{if(!G||!n)return;let o=0;if(t<.15)o=t/.15;else if(t>=.15&&t<=.85)o=1;else if(t>.85&&t<1)o=(1-t)/.15;else return;const f=800,v=400;e.save();const w=Math.atan2(l.y-i.y,l.x-i.x),a=(i.x+l.x)/2,s=(i.y+l.y)/2;e.translate(a,s),e.rotate(w),e.globalAlpha=o,e.drawImage(n,-f/2,-v/2,f,v),e.restore()},V=(e,i,l,t,n)=>{if(!G||!Ee||!ae.current)return;let o=0;if(t<.15)o=t/.15;else if(t>=.15&&t<=.85)o=1;else if(t>.85&&t<1)o=(1-t)/.15;else return;const f=ae.current,v=l,w=l;e.save(),e.translate(i.x,i.y),e.rotate(n),e.globalAlpha=o,e.drawImage(f,0,-w,v,w),e.restore()},B=[{notation:"Daný trojúhelník ABC a osa souměrnosti x",description:"Zadání úlohy",type:"point"},{notation:"p ⊥ x, A ∈ p",description:"Kolmice od bodu A",type:"perpendicular"},{notation:"q ⊥ x, B ∈ q",description:"Kolmice od bodu B",type:"perpendicular"},{notation:"r ⊥ x, C ∈ r",description:"Kolmice od bodu C",type:"perpendicular"},{notation:"k(A, |Ax|)",description:"Kružnice se středem A",type:"circle"},{notation:"A' = k ∩ p, A' ∈ p, |Ax| = |A'x|",description:"Bod A'",type:"point"},{notation:"l(B, |Bx|)",description:"Kružnice se středem B",type:"circle"},{notation:"B' = l ∩ q, B' ∈ q, |Bx| = |B'x|",description:"Bod B'",type:"point"},{notation:"m(C, |Cx|)",description:"Kružnice se středem C",type:"circle"},{notation:"C' = m ∩ r, C' ∈ r, |Cx| = |C'x|",description:"Bod C'",type:"point"},{notation:"A'B'C'",description:"Spojení bodů",type:"segment"}],_=[{id:0,title:"Zadání úlohy",description:"Máme trojúhelník ABC a osu souměrnosti x. Najdeme obraz trojúhelníku v osové souměrnosti. Body můžeš přesouvat myší!",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4),u(e,n,o,s,4),u(e,o,t,s,4),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:1,title:"Narýsuj kolmici od bodu A",description:"Od bodu A narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const g={x:5e3,y:t.y};u(e,t,g,y,3,f,!0);const S=t.y-200,P={x:r-400,y:S},C={x:r+400,y:S};le(e,P,C,f,te.current),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:2,title:"Narýsuj kolmici od bodu B",description:"Od bodu B narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const g={x:5e3,y:t.y};u(e,t,g,y,3,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,f,!0);const P=n.y-200,C={x:r-400,y:P},T={x:r+400,y:P};le(e,C,T,f,te.current),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:3,title:"Narýsuj kolmici od bodu C",description:"Od bodu C narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const g={x:5e3,y:t.y};u(e,t,g,y,3,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:o.y};u(e,o,P,y,3,f,!0);const C=o.y-200,T={x:r-400,y:C},Y={x:r+400,y:C};le(e,T,Y,f,te.current),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:4,title:"Změř vzdálenost bodu A od osy",description:"Nastav kružítko na vzdálenost od bodu A k ose x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const g={x:5e3,y:t.y};u(e,t,g,y,3,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:o.y};u(e,o,P,y,3,1,!1);const C={x:r,y:t.y},T=Math.abs(t.x-r),Y=Math.atan2(C.y-t.y,C.x-t.x);V(e,t,T,f,Y),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:5,title:"Přenes vzdálenost a vytvoř bod A'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod A'.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:n.y};u(e,n,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const T={x:r,y:t.y},Y=Math.abs(t.x-r),I={x:r+(r-t.x),y:t.y},X=Math.atan2(I.y-T.y,I.x-T.x);V(e,T,Y,f,X),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),f>.5&&h(e,I,"A'",g),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),f>.5&&c(e,I,"A'",g,12,-12,a)}},{id:6,title:"Změř vzdálenost bodu B od osy",description:"Nastav kružítko na vzdálenost od bodu B k ose x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:n.y};u(e,n,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const T={x:r+(r-t.x),y:t.y};h(e,T,"A'",g);const Y={x:r,y:n.y},I=Math.abs(n.x-r),X=Math.atan2(Y.y-n.y,Y.x-n.x);V(e,n,I,f,X),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,T,"A'",g,12,-12,a)}},{id:7,title:"Přenes vzdálenost a vytvoř bod B'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod B'.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:n.y};u(e,n,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const T={x:r+(r-t.x),y:t.y};h(e,T,"A'",b);const Y={x:r,y:n.y},I=Math.abs(n.x-r),X={x:r+(r-n.x),y:n.y},q=Math.atan2(X.y-Y.y,X.x-Y.x);V(e,Y,I,f,q),f>.5&&h(e,X,"B'",g),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,T,"A'",g,12,-12,a),f>.5&&c(e,X,"B'",g,12,-12,a)}},{id:8,title:"Změř vzdálenost bodu C od osy",description:"Nastav kružítko na vzdálenost od bodu C k ose x.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:n.y};u(e,n,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const T={x:r+(r-t.x),y:t.y},Y={x:r+(r-n.x),y:n.y};h(e,T,"A'",g),h(e,Y,"B'",g);const I={x:r,y:o.y},X=Math.abs(o.x-r),q=Math.atan2(I.y-o.y,I.x-o.x);V(e,o,X,f,q),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,T,"A'",g,12,-12,a),c(e,Y,"B'",g,12,-12,a)}},{id:9,title:"Přenes vzdálenost a vytvoř bod C'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod C'.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:n.y};u(e,n,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const T={x:r+(r-t.x),y:t.y},Y={x:r+(r-n.x),y:n.y};h(e,T,"A'",g),h(e,Y,"B'",g);const I={x:r,y:o.y},X=Math.abs(o.x-r),q={x:r+(r-o.x),y:o.y},Ge=Math.atan2(q.y-I.y,q.x-I.x);V(e,I,X,f,Ge),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),f>.5&&h(e,q,"C'",g),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,T,"A'",g,12,-12,a),c(e,Y,"B'",g,12,-12,a),f>.5&&c(e,q,"C'",g,12,-12,a)}},{id:10,title:"Spoj body A'B'C'",description:"Spoj body A', B' a C' a vznikne zrcadlený trojúhelník.",draw:(e,i,l,t,n,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,t,n,s,4,1,!1),u(e,n,o,s,4,1,!1),u(e,o,t,s,4,1,!1);const g={x:r+(r-t.x),y:t.y},S={x:r+(r-n.x),y:n.y},P={x:r+(r-o.x),y:o.y};let C=0;f<.33?(C=f/.33,u(e,g,S,y,4,C,!0)):f<.66?(u(e,g,S,y,4,1,!1),C=(f-.33)/.33,u(e,S,P,y,4,C,!0)):(u(e,g,S,y,4,1,!1),u(e,S,P,y,4,1,!1),C=(f-.66)/.34,u(e,P,g,y,4,C,!0)),h(e,t,"A",s),h(e,n,"B",s),h(e,o,"C",s),h(e,g,"A'",y),h(e,S,"B'",y),h(e,P,"C'",y),c(e,t,"A",s,-25,-12,a),c(e,n,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,g,"A'",y,12,-12,a),c(e,S,"B'",y,12,-12,a),c(e,P,"C'",y,12,-12,a)}}],Ze=(e,i)=>{const l=window.devicePixelRatio||1;if(!(!k.current||k.current.width===0||k.current.height===0)){e.clearRect(0,0,k.current.width,k.current.height),e.save(),e.scale(l,l),Fe(e),e.translate(A.x,A.y),e.scale(j,j);for(let t=0;t<R;t++)_[t].draw(e,j,A,D,N,W,1,R,_[t].id);_[R].draw(e,j,A,D,N,W,i,R,_[R].id),e.restore()}},qe=()=>{if(!E.current||!k.current)return;const e=E.current,i=e.getContext("2d");if(!i)return;const l=k.current.getContext("2d");l&&Ze(l,U),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),i.fillStyle=d?"#1a1b26":"#ffffff",i.fillRect(0,0,e.width,e.height),i.drawImage(k.current,0,0)};m.useEffect(()=>{qe()},[U,R,j,A,d,G,p,D,N,W,me]);const Se=e=>{je(e),fe(0),ie(!0)},Ke=()=>{Se(0),we()},_e=e=>{const i=E.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,t=e.clientY-i.top,n=H(l,t),o={x:l,y:t};if(L(D,n)||F(D,o,{x:-25,y:-12})){Z("A"),e.preventDefault();return}if(L(N,n)||F(N,o,{x:12,y:12})){Z("B"),e.preventDefault();return}if(L(W,n)||F(W,o,{x:-25,y:-12})){Z("C"),e.preventDefault();return}Q(!0),ce({x:e.clientX-A.x,y:e.clientY-A.y})},$e=e=>{const i=E.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,t=e.clientY-i.top,n=H(l,t),o={x:l,y:t};if(K==="A"){ye(n);return}if(K==="B"){he(n);return}if(K==="C"){ge(n);return}if(se){$({x:e.clientX-M.x,y:e.clientY-M.y});return}L(D,n)||F(D,o,{x:-25,y:-12})?x("A"):L(N,n)||F(N,o,{x:12,y:12})?x("B"):L(W,n)||F(W,o,{x:-25,y:-12})?x("C"):x(null)},Ce=()=>{Q(!1),Z(null)},Pe=(e,i)=>{const l=e.clientX-i.clientX,t=e.clientY-i.clientY;return Math.sqrt(l*l+t*t)},Oe=(e,i)=>({x:(e.clientX+i.clientX)/2,y:(e.clientY+i.clientY)/2}),He=e=>{const i=E.current?.getBoundingClientRect();if(!i)return;if(e.touches.length===2){const v=Pe(e.touches[0],e.touches[1]),w=Oe(e.touches[0],e.touches[1]);ve(!0),ke(v),Ne(j),We(w),e.preventDefault();return}if(e.touches.length!==1)return;const l=e.touches[0],t=l.clientX-i.left,n=l.clientY-i.top,o=H(t,n),f={x:t,y:n};if(L(D,o)||F(D,f,{x:-25,y:-12})){Z("A"),e.preventDefault();return}if(L(N,o)||F(N,f,{x:12,y:12})){Z("B"),e.preventDefault();return}if(L(W,o)||F(W,f,{x:-25,y:-12})){Z("C"),e.preventDefault();return}Q(!0),ce({x:l.clientX-A.x,y:l.clientY-A.y})},Ve=e=>{const i=E.current?.getBoundingClientRect();if(!i)return;if(Ie&&e.touches.length===2){const f=Pe(e.touches[0],e.touches[1]),v=Math.max(.2,Math.min(.6,De*(f/Xe))),w=H(ee.x,ee.y);oe(v),$({x:ee.x-w.x*v,y:ee.y-w.y*v}),e.preventDefault();return}if(e.touches.length!==1)return;const l=e.touches[0],t=l.clientX-i.left,n=l.clientY-i.top,o=H(t,n);if(K==="A"){ye(o),e.preventDefault();return}if(K==="B"){he(o),e.preventDefault();return}if(K==="C"){ge(o),e.preventDefault();return}se&&($({x:l.clientX-M.x,y:l.clientY-M.y}),e.preventDefault())},Re=()=>{Q(!1),Z(null),ve(!1)},Ue=e=>{e.preventDefault();const i=E.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,t=e.clientY-i.top,n=H(l,t),o=e.deltaY>0?.9:1.1,f=Math.max(.2,Math.min(.6,j*o));oe(f),$({x:l-n.x*f,y:t-n.y*f})};return z.jsxs("div",{className:"size-full flex flex-col relative",children:[z.jsx("div",{ref:J,className:`flex-1 ${d?"bg-[#1a1b26]":"bg-white"}`,children:z.jsx("canvas",{ref:E,className:"w-full h-full",style:{cursor:K?"grabbing":me?"move":se?"grabbing":"grab",touchAction:"none"},onMouseDown:_e,onMouseMove:$e,onMouseUp:Ce,onMouseLeave:Ce,onTouchStart:He,onTouchMove:Ve,onTouchEnd:Re,onTouchCancel:Re,onWheel:Ue})}),z.jsxs("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 z-10 rounded-2xl shadow-lg max-w-2xl ${d?"bg-gray-900 border border-gray-800 text-[#c0caf5]":"bg-white border border-gray-200 text-gray-900"}`,style:{fontFamily:"var(--font-family, 'Fenomen Sans', sans-serif)",padding:"24px 40px"},children:[z.jsxs("div",{className:`text-base font-medium mb-3 ${d?"text-[#565f89]":"text-gray-400"}`,children:["Krok ",R+1," / ",_.length]}),z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsx("span",{className:"flex items-center justify-center w-10 h-10 rounded-full text-sm font-bold shrink-0",style:{backgroundColor:B[R]?.type==="circle"?"#f43f5e":B[R]?.type==="segment"?"#10b981":B[R]?.type==="line"?"#8b5cf6":B[R]?.type==="perpendicular"?"#06b6d4":"#3b82f6",color:"#fff"},children:B[R]?.type==="circle"?"○":B[R]?.type==="segment"?"—":B[R]?.type==="line"?"↔":B[R]?.type==="perpendicular"?"⊥":"•"}),z.jsxs("span",{className:"text-xl font-medium",style:{fontFamily:'"Times New Roman", Georgia, serif',fontStyle:"italic"},children:[R+1,". ",B[R]?.notation]})]}),z.jsx("div",{className:`text-base mt-2.5 ${d?"text-[#565f89]":"text-gray-500"}`,children:_[R]?.description})]}),z.jsx(xe,{currentStep:R,totalSteps:_.length,showCaptions:G,darkMode:d,scale:j,onStepChange:Se,onRestart:Ke,onToggleCaptions:()=>Ye(!G),onToggleDarkMode:()=>Te(!d),onZoomChange:e=>{const i=Math.max(.2,Math.min(.6,e)),l=p.width/2,t=p.height/2,n=(l-A.x)/j,o=(t-A.y)/j;oe(i),$({x:l-n*i,y:t-o*i})}}),z.jsx(et,{steps:B,currentStep:R,constructionTitle:"Osová souměrnost",darkMode:d,visible:O,onClose:()=>re(!1)}),z.jsxs("button",{onClick:ue,onTouchEnd:e=>{e.preventDefault(),ue()},className:`absolute top-4 left-4 z-10 flex items-center gap-2 px-3 py-2 rounded-xl shadow-[0_2px_12px_rgba(0,0,0,0.08)] transition-all ${d?"bg-[#1a1b26]/90 hover:bg-[#24283b] text-[#c0caf5] border border-[#2a2b3d] backdrop-blur-sm":"bg-white/90 hover:bg-gray-50 border border-gray-200/60 backdrop-blur-sm"}`,children:[z.jsx(Je,{className:"size-5"}),z.jsx("span",{className:"text-sm font-medium",children:"Menu"})]}),z.jsx("div",{className:`absolute top-4 z-10 transition-all duration-300 ${O?"right-[576px]":"right-4"}`,children:z.jsxs("button",{onClick:()=>re(!O),onTouchEnd:e=>{e.preventDefault(),re(!O)},className:`p-3 rounded-xl transition-all relative group/protocol ${O?d?"bg-[#7aa2f7] text-white":"bg-[#1e1b4b] text-white":d?"bg-[#24283b] hover:bg-[#414868] text-[#c0caf5]":"bg-white/90 hover:bg-gray-50 text-gray-700 shadow-[0_2px_12px_rgba(0,0,0,0.08)] border border-gray-200/60 backdrop-blur-sm"}`,title:"Zápis konstrukce",children:[z.jsx(Me,{className:"size-5"}),!O&&z.jsx("div",{className:"absolute right-0 top-full mt-2 px-3 py-1.5 bg-black/80 text-white text-xs rounded-lg whitespace-nowrap opacity-0 group-hover/protocol:opacity-100 transition-opacity pointer-events-none",children:"Zápis konstrukce"})]})})]})}export{it as AxialSymmetryConstruction};
