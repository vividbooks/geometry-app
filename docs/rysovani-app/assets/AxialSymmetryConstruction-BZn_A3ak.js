import{r as m,j as I,A as Je}from"./index-XwFAIRJN.js";import{u as Qe,F as Me}from"./slider-DIjnFkRt.js";import{C as xe,a as en}from"./ConstructionStepLog-CiBFSXbR.js";function rn({onBack:le,darkMode:d,onDarkModeChange:Re}){const Te=Qe(),N=m.useRef(null),p=m.useRef(null),G=m.useRef(null),ne=m.useRef(),[D,je]=m.useState(0),[j,te]=m.useState(Te?.2:.4),[A,_]=m.useState({x:0,y:0}),[oe,J]=m.useState(!1),[Q,ue]=m.useState({x:0,y:0}),[T,Ae]=m.useState({width:1920,height:1080}),[V,ce]=m.useState(0),[fe,se]=m.useState(!0),[U,Ye]=m.useState(!0),[$,ie]=m.useState(!1),[k,de]=m.useState({x:600,y:700}),[W,ye]=m.useState({x:1100,y:900}),[B,he]=m.useState({x:800,y:400}),[q,Z]=m.useState(null),[ge,M]=m.useState(null),[me,ze]=m.useState(!1),r=1400,[Ie,be]=m.useState(!1),[Xe,pe]=m.useState(0),[De,ke]=m.useState(1),[x,We]=m.useState({x:0,y:0});m.useEffect(()=>{p.current||(p.current=document.createElement("canvas"))},[]);const ee=m.useRef(null),[nn,Be]=m.useState(!1);m.useEffect(()=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{ee.current=e,Be(!0)},e.onerror=()=>{console.error("Failed to load ruler image")},e.src="https://jjpiguuubvmiobmixwgh.supabase.co/storage/v1/object/public/Admin%20math/pravitko4.svg"},[]);const re=m.useRef(null),[Ne,Ee]=m.useState(!1);m.useEffect(()=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{re.current=e,Ee(!0)},e.onerror=()=>{console.error("Failed to load compass image")},e.src="https://jjpiguuubvmiobmixwgh.supabase.co/storage/v1/object/public/Admin%20math/kruzitko.svg"},[]);const O=(e,i)=>({x:(e-A.x)/j,y:(i-A.y)/j}),E=(e,i,l=15)=>{const n=e.x-i.x,t=e.y-i.y;return Math.sqrt(n*n+t*t)<l},L=(e,i,l)=>{const n=e.x*j+A.x,t=e.y*j+A.y,o=n+l.x,f=t+l.y,v=20,w=i.x-o,a=i.y-(f-8);return Math.sqrt(w*w+a*a)<v},ve=()=>{if(!T.width||!T.height)return;const e=T.width/2,i=T.height/2,l=(k.y+W.y+B.y)/3;_({x:e-r*j,y:i-l*j})};m.useEffect(()=>{const e=()=>{G.current&&Ae({width:G.current.clientWidth,height:G.current.clientHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),m.useEffect(()=>{T.width>0&&T.height>0&&(ve(),me||ze(!0))},[T.width,T.height,me]),m.useEffect(()=>{const e=N.current,i=p.current;if(!e||!i)return;const l=window.devicePixelRatio||1;e.width=T.width*l,e.height=T.height*l,i.width=T.width*l,i.height=T.height*l},[T]),m.useEffect(()=>{if(!fe)return;const e=()=>{ce(i=>i>=1?(se(!1),1):Math.min(i+.009,1))};return V<1?ne.current=requestAnimationFrame(e):V>=1&&se(!1),()=>{ne.current&&cancelAnimationFrame(ne.current)}},[fe,V,D]);const Le=e=>{let i=50*j;for(;i<35;)i*=2;e.strokeStyle=d?"rgba(125, 107, 194, 0.15)":"rgba(229, 231, 235, 0.8)",e.lineWidth=1;const l=A.x%i,n=A.y%i;for(let t=l;t<=T.width;t+=i)e.beginPath(),e.moveTo(t,0),e.lineTo(t,T.height),e.stroke();for(let t=n;t<=T.height;t+=i)e.beginPath(),e.moveTo(0,t),e.lineTo(T.width,t),e.stroke()},c=(e,i,l,n="#000",t=12,o=-12,f=1)=>{e.save(),e.setTransform(f,0,0,f,0,0);const v=i.x*j+A.x,w=i.y*j+A.y;e.font="bold 16px Inter, system-ui, sans-serif";const s=e.measureText(l).width,b=8,y=v+t+s/2,g=w+o-8,S=Math.max(s,16)/2+b;e.fillStyle="#3b82f6",e.beginPath(),e.arc(y,g,S,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.textAlign="center",e.textBaseline="middle",e.fillText(l,y,g),e.restore()},h=(e,i,l,n="#000")=>{e.fillStyle=d?"rgba(75, 85, 99, 0.4)":"rgba(200, 200, 200, 0.3)",e.beginPath(),e.arc(i.x,i.y,10,0,Math.PI*2),e.fill(),e.fillStyle=n,e.beginPath(),e.arc(i.x,i.y,7,0,Math.PI*2),e.fill(),e.strokeStyle=d?"#111827":"#ffffff",e.lineWidth=2,e.beginPath(),e.arc(i.x,i.y,7,0,Math.PI*2),e.stroke()},u=(e,i,l,n="#000",t=2,o=1,f=!1)=>{let v=0;o<=.15?v=0:o>=.85?v=1:v=(o-.15)/.7;const w={x:i.x+(l.x-i.x)*v,y:i.y+(l.y-i.y)*v},a=v<1;f&&a&&v>0&&(e.strokeStyle="rgba(251, 191, 36, 0.5)",e.lineWidth=t*10,e.lineCap="round",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(w.x,w.y),e.stroke()),e.strokeStyle=n,e.lineWidth=a&&f?t*1.5:t,e.lineCap="round",e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(w.x,w.y),e.stroke()},ae=(e,i,l,n,t)=>{if(!U||!t)return;let o=0;if(n<.15)o=n/.15;else if(n>=.15&&n<=.85)o=1;else if(n>.85&&n<1)o=(1-n)/.15;else return;const f=800,v=400;e.save();const w=Math.atan2(l.y-i.y,l.x-i.x),a=(i.x+l.x)/2,s=(i.y+l.y)/2;e.translate(a,s),e.rotate(w),e.globalAlpha=o,e.drawImage(t,-f/2,-v/2,f,v),e.restore()},H=(e,i,l,n,t)=>{if(!U||!Ne||!re.current)return;let o=0;if(n<.15)o=n/.15;else if(n>=.15&&n<=.85)o=1;else if(n>.85&&n<1)o=(1-n)/.15;else return;const f=re.current,v=l,w=l;e.save(),e.translate(i.x,i.y),e.rotate(t),e.globalAlpha=o,e.drawImage(f,0,-w,v,w),e.restore()},Ze=[{notation:"Daný trojúhelník ABC a osa souměrnosti x",description:"Zadání úlohy",type:"point"},{notation:"p ⊥ x, A ∈ p",description:"Kolmice od bodu A",type:"perpendicular"},{notation:"q ⊥ x, B ∈ q",description:"Kolmice od bodu B",type:"perpendicular"},{notation:"r ⊥ x, C ∈ r",description:"Kolmice od bodu C",type:"perpendicular"},{notation:"k(A, |Ax|)",description:"Kružnice se středem A",type:"circle"},{notation:"A' = k ∩ p, A' ∈ p, |Ax| = |A'x|",description:"Bod A'",type:"point"},{notation:"l(B, |Bx|)",description:"Kružnice se středem B",type:"circle"},{notation:"B' = l ∩ q, B' ∈ q, |Bx| = |B'x|",description:"Bod B'",type:"point"},{notation:"m(C, |Cx|)",description:"Kružnice se středem C",type:"circle"},{notation:"C' = m ∩ r, C' ∈ r, |Cx| = |C'x|",description:"Bod C'",type:"point"},{notation:"A'B'C'",description:"Spojení bodů",type:"segment"}],K=[{id:0,title:"Zadání úlohy",description:"Máme trojúhelník ABC a osu souměrnosti x. Najdeme obraz trojúhelníku v osové souměrnosti. Body můžeš přesouvat myší!",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4),u(e,t,o,s,4),u(e,o,n,s,4),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:1,title:"Narýsuj kolmici od bodu A",description:"Od bodu A narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const g={x:5e3,y:n.y};u(e,n,g,y,3,f,!0);const S=n.y-200,P={x:r-400,y:S},C={x:r+400,y:S};ae(e,P,C,f,ee.current),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:2,title:"Narýsuj kolmici od bodu B",description:"Od bodu B narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const g={x:5e3,y:n.y};u(e,n,g,y,3,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,f,!0);const P=t.y-200,C={x:r-400,y:P},R={x:r+400,y:P};ae(e,C,R,f,ee.current),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:3,title:"Narýsuj kolmici od bodu C",description:"Od bodu C narýsuj vodorovnou čáru kolmou na osu x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const g={x:5e3,y:n.y};u(e,n,g,y,3,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:o.y};u(e,o,P,y,3,f,!0);const C=o.y-200,R={x:r-400,y:C},Y={x:r+400,y:C};ae(e,R,Y,f,ee.current),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:4,title:"Změř vzdálenost bodu A od osy",description:"Nastav kružítko na vzdálenost od bodu A k ose x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const g={x:5e3,y:n.y};u(e,n,g,y,3,1,!1);const S={x:5e3,y:t.y};u(e,t,S,y,3,1,!1);const P={x:5e3,y:o.y};u(e,o,P,y,3,1,!1);const C={x:r,y:n.y},R=Math.abs(n.x-r),Y=Math.atan2(C.y-n.y,C.x-n.x);H(e,n,R,f,Y),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a)}},{id:5,title:"Přenes vzdálenost a vytvoř bod A'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod A'.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:t.y};u(e,t,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const R={x:r,y:n.y},Y=Math.abs(n.x-r),z={x:r+(r-n.x),y:n.y},X=Math.atan2(z.y-R.y,z.x-R.x);H(e,R,Y,f,X),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),f>.5&&h(e,z,"A'",g),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),f>.5&&c(e,z,"A'",g,12,-12,a)}},{id:6,title:"Změř vzdálenost bodu B od osy",description:"Nastav kružítko na vzdálenost od bodu B k ose x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:t.y};u(e,t,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const R={x:r+(r-n.x),y:n.y};h(e,R,"A'",g);const Y={x:r,y:t.y},z=Math.abs(t.x-r),X=Math.atan2(Y.y-t.y,Y.x-t.x);H(e,t,z,f,X),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,R,"A'",g,12,-12,a)}},{id:7,title:"Přenes vzdálenost a vytvoř bod B'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod B'.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:t.y};u(e,t,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const R={x:r+(r-n.x),y:n.y};h(e,R,"A'",b);const Y={x:r,y:t.y},z=Math.abs(t.x-r),X={x:r+(r-t.x),y:t.y},F=Math.atan2(X.y-Y.y,X.x-Y.x);H(e,Y,z,f,F),f>.5&&h(e,X,"B'",g),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,R,"A'",g,12,-12,a),f>.5&&c(e,X,"B'",g,12,-12,a)}},{id:8,title:"Změř vzdálenost bodu C od osy",description:"Nastav kružítko na vzdálenost od bodu C k ose x.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:t.y};u(e,t,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const R={x:r+(r-n.x),y:n.y},Y={x:r+(r-t.x),y:t.y};h(e,R,"A'",g),h(e,Y,"B'",g);const z={x:r,y:o.y},X=Math.abs(o.x-r),F=Math.atan2(z.y-o.y,z.x-o.x);H(e,o,X,f,F),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,R,"A'",g,12,-12,a),c(e,Y,"B'",g,12,-12,a)}},{id:9,title:"Přenes vzdálenost a vytvoř bod C'",description:"Zapíchni kružítko do průsečíku na ose a přenes vzdálenost na druhou stranu. Vytvoř bod C'.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#4ade80":"#22c55e",g=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const S={x:5e3,y:n.y};u(e,n,S,y,3,1,!1);const P={x:5e3,y:t.y};u(e,t,P,y,3,1,!1);const C={x:5e3,y:o.y};u(e,o,C,y,3,1,!1);const R={x:r+(r-n.x),y:n.y},Y={x:r+(r-t.x),y:t.y};h(e,R,"A'",g),h(e,Y,"B'",g);const z={x:r,y:o.y},X=Math.abs(o.x-r),F={x:r+(r-o.x),y:o.y},Ge=Math.atan2(F.y-z.y,F.x-z.x);H(e,z,X,f,Ge),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),f>.5&&h(e,F,"C'",g),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,R,"A'",g,12,-12,a),c(e,Y,"B'",g,12,-12,a),f>.5&&c(e,F,"C'",g,12,-12,a)}},{id:10,title:"Spoj body A'B'C'",description:"Spoj body A', B' a C' a vznikne zrcadlený trojúhelník.",draw:(e,i,l,n,t,o,f,v,w)=>{const a=window.devicePixelRatio||1,s=d?"#e5e7eb":"#1f2937",b=d?"#fca5a5":"#ef4444",y=d?"#60a5fa":"#3b82f6";e.strokeStyle=b,e.lineWidth=5,e.lineCap="butt",e.beginPath(),e.moveTo(r,-5e3),e.lineTo(r,5e3),e.stroke(),c(e,{x:r,y:200},"x",b,15,0,a),u(e,n,t,s,4,1,!1),u(e,t,o,s,4,1,!1),u(e,o,n,s,4,1,!1);const g={x:r+(r-n.x),y:n.y},S={x:r+(r-t.x),y:t.y},P={x:r+(r-o.x),y:o.y};let C=0;f<.33?(C=f/.33,u(e,g,S,y,4,C,!0)):f<.66?(u(e,g,S,y,4,1,!1),C=(f-.33)/.33,u(e,S,P,y,4,C,!0)):(u(e,g,S,y,4,1,!1),u(e,S,P,y,4,1,!1),C=(f-.66)/.34,u(e,P,g,y,4,C,!0)),h(e,n,"A",s),h(e,t,"B",s),h(e,o,"C",s),h(e,g,"A'",y),h(e,S,"B'",y),h(e,P,"C'",y),c(e,n,"A",s,-25,-12,a),c(e,t,"B",s,12,12,a),c(e,o,"C",s,-25,-12,a),c(e,g,"A'",y,12,-12,a),c(e,S,"B'",y,12,-12,a),c(e,P,"C'",y,12,-12,a)}}],Fe=(e,i)=>{const l=window.devicePixelRatio||1;if(!(!p.current||p.current.width===0||p.current.height===0)){e.clearRect(0,0,p.current.width,p.current.height),e.save(),e.scale(l,l),Le(e),e.translate(A.x,A.y),e.scale(j,j);for(let n=0;n<D;n++)K[n].draw(e,j,A,k,W,B,1,D,K[n].id);K[D].draw(e,j,A,k,W,B,i,D,K[D].id),e.restore()}},qe=()=>{if(!N.current||!p.current)return;const e=N.current,i=e.getContext("2d");if(!i)return;const l=p.current.getContext("2d");l&&Fe(l,V),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),i.fillStyle=d?"#1a1b26":"#ffffff",i.fillRect(0,0,e.width,e.height),i.drawImage(p.current,0,0)};m.useEffect(()=>{qe()},[V,D,j,A,d,U,T,k,W,B,ge]);const we=e=>{je(e),ce(0),se(!0)},Ke=()=>{we(0),ve()},_e=e=>{const i=N.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,n=e.clientY-i.top,t=O(l,n),o={x:l,y:n};if(E(k,t)||L(k,o,{x:-25,y:-12})){Z("A"),e.preventDefault();return}if(E(W,t)||L(W,o,{x:12,y:12})){Z("B"),e.preventDefault();return}if(E(B,t)||L(B,o,{x:-25,y:-12})){Z("C"),e.preventDefault();return}J(!0),ue({x:e.clientX-A.x,y:e.clientY-A.y})},$e=e=>{const i=N.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,n=e.clientY-i.top,t=O(l,n),o={x:l,y:n};if(q==="A"){de(t);return}if(q==="B"){ye(t);return}if(q==="C"){he(t);return}if(oe){_({x:e.clientX-Q.x,y:e.clientY-Q.y});return}E(k,t)||L(k,o,{x:-25,y:-12})?M("A"):E(W,t)||L(W,o,{x:12,y:12})?M("B"):E(B,t)||L(B,o,{x:-25,y:-12})?M("C"):M(null)},Se=()=>{J(!1),Z(null)},Ce=(e,i)=>{const l=e.clientX-i.clientX,n=e.clientY-i.clientY;return Math.sqrt(l*l+n*n)},Oe=(e,i)=>({x:(e.clientX+i.clientX)/2,y:(e.clientY+i.clientY)/2}),He=e=>{const i=N.current?.getBoundingClientRect();if(!i)return;if(e.touches.length===2){const v=Ce(e.touches[0],e.touches[1]),w=Oe(e.touches[0],e.touches[1]);be(!0),pe(v),ke(j),We(w),e.preventDefault();return}if(e.touches.length!==1)return;const l=e.touches[0],n=l.clientX-i.left,t=l.clientY-i.top,o=O(n,t),f={x:n,y:t};if(E(k,o)||L(k,f,{x:-25,y:-12})){Z("A"),e.preventDefault();return}if(E(W,o)||L(W,f,{x:12,y:12})){Z("B"),e.preventDefault();return}if(E(B,o)||L(B,f,{x:-25,y:-12})){Z("C"),e.preventDefault();return}J(!0),ue({x:l.clientX-A.x,y:l.clientY-A.y})},Ve=e=>{const i=N.current?.getBoundingClientRect();if(!i)return;if(Ie&&e.touches.length===2){const f=Ce(e.touches[0],e.touches[1]),v=Math.max(.2,Math.min(.6,De*(f/Xe))),w=O(x.x,x.y);te(v),_({x:x.x-w.x*v,y:x.y-w.y*v}),e.preventDefault();return}if(e.touches.length!==1)return;const l=e.touches[0],n=l.clientX-i.left,t=l.clientY-i.top,o=O(n,t);if(q==="A"){de(o),e.preventDefault();return}if(q==="B"){ye(o),e.preventDefault();return}if(q==="C"){he(o),e.preventDefault();return}oe&&(_({x:l.clientX-Q.x,y:l.clientY-Q.y}),e.preventDefault())},Pe=()=>{J(!1),Z(null),be(!1)},Ue=e=>{e.preventDefault();const i=N.current?.getBoundingClientRect();if(!i)return;const l=e.clientX-i.left,n=e.clientY-i.top,t=O(l,n),o=e.deltaY>0?.9:1.1,f=Math.max(.2,Math.min(.6,j*o));te(f),_({x:l-t.x*f,y:n-t.y*f})};return I.jsxs("div",{className:"size-full flex flex-col relative",children:[I.jsx("div",{ref:G,className:`flex-1 ${d?"bg-[#1a1b26]":"bg-white"}`,children:I.jsx("canvas",{ref:N,className:"w-full h-full",style:{cursor:q?"grabbing":ge?"move":oe?"grabbing":"grab",touchAction:"none"},onMouseDown:_e,onMouseMove:$e,onMouseUp:Se,onMouseLeave:Se,onTouchStart:He,onTouchMove:Ve,onTouchEnd:Pe,onTouchCancel:Pe,onWheel:Ue})}),I.jsxs("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 z-10 rounded-2xl shadow-lg max-w-2xl ${d?"bg-gray-900 border border-gray-800 text-[#c0caf5]":"bg-white border border-gray-200 text-gray-900"}`,style:{fontFamily:"var(--font-family, 'Fenomen Sans', sans-serif)",padding:"24px 40px"},children:[I.jsxs("div",{className:`text-base font-medium mb-3 ${d?"text-[#565f89]":"text-gray-400"}`,children:["Krok ",D+1," / ",K.length]}),I.jsx("div",{className:`text-lg font-medium ${d?"text-[#c0caf5]":"text-gray-800"}`,children:K[D]?.description})]}),I.jsx(xe,{currentStep:D,totalSteps:K.length,showCaptions:U,darkMode:d,scale:j,onStepChange:we,onRestart:Ke,onToggleCaptions:()=>Ye(!U),onToggleDarkMode:()=>Re(!d),onZoomChange:e=>{const i=Math.max(.2,Math.min(.6,e)),l=T.width/2,n=T.height/2,t=(l-A.x)/j,o=(n-A.y)/j;te(i),_({x:l-t*i,y:n-o*i})}}),I.jsx(en,{steps:Ze,currentStep:D,constructionTitle:"Osová souměrnost",darkMode:d,visible:$,onClose:()=>ie(!1)}),I.jsxs("button",{onClick:le,onTouchEnd:e=>{e.preventDefault(),le()},className:`absolute top-4 left-4 z-10 flex items-center gap-2 px-3 py-2 rounded-xl shadow-[0_2px_12px_rgba(0,0,0,0.08)] transition-all ${d?"bg-[#1a1b26]/90 hover:bg-[#24283b] text-[#c0caf5] border border-[#2a2b3d] backdrop-blur-sm":"bg-white/90 hover:bg-gray-50 border border-gray-200/60 backdrop-blur-sm"}`,children:[I.jsx(Je,{className:"size-5"}),I.jsx("span",{className:"text-sm font-medium",children:"Menu"})]}),I.jsx("div",{className:`absolute top-4 z-10 transition-all duration-300 ${$?"right-[576px]":"right-4"}`,children:I.jsxs("button",{onClick:()=>ie(!$),onTouchEnd:e=>{e.preventDefault(),ie(!$)},className:`p-3 rounded-xl transition-all relative group/protocol ${$?d?"bg-[#7aa2f7] text-white":"bg-[#1e1b4b] text-white":d?"bg-[#24283b] hover:bg-[#414868] text-[#c0caf5]":"bg-white/90 hover:bg-gray-50 text-gray-700 shadow-[0_2px_12px_rgba(0,0,0,0.08)] border border-gray-200/60 backdrop-blur-sm"}`,title:"Zápis konstrukce",children:[I.jsx(Me,{className:"size-5"}),!$&&I.jsx("div",{className:"absolute right-0 top-full mt-2 px-3 py-1.5 bg-black/80 text-white text-xs rounded-lg whitespace-nowrap opacity-0 group-hover/protocol:opacity-100 transition-opacity pointer-events-none",children:"Zápis konstrukce"})]})})]})}export{rn as AxialSymmetryConstruction};
